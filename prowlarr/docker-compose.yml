services:
  # Prowlarr
  prowlarr:
    container_name: prowlarr
    image: lscr.io/linuxserver/prowlarr:2.1.5@sha256:643220338204525524db787ff38a607261597f49d1f550694acdb3e908e2b43e
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      # - UMASK=002
      - TZ=${TIMEZONE}
    labels:
      - traefik.enable=true
      - traefik.http.routers.prowlarr.rule=Host(`prowlarr.${DOMAIN_NAME}`)
      - traefik.http.routers.prowlarr.entrypoints=websecure
      - traefik.http.routers.prowlarr.tls=true
      - traefik.http.routers.prowlarr.tls.certresolver=myclouddns
      - traefik.http.routers.prowlarr.middlewares=crowdsec-bouncer@docker,authelia-forwardauth@docker,geoblock@file
      - homepage.group=Servarr
      - homepage.name=Prowlarr
      - homepage.icon=prowlarr.png
      - homepage.href=http://prowlarr.${DOMAIN_NAME}/
      - homepage.description=Indexer manager
      - homepage.widget.type=prowlarr
      - homepage.widget.url=http://prowlarr:9696
      - homepage.widget.key=${PROWLARR_API_KEY}
    volumes:
      - ${DATADIR}/prowlarr/config:/config
    restart: unless-stopped
    networks:
      - internal

networks:
  internal:
    external: true